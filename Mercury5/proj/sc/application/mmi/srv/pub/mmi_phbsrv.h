/**
* @file mmi_phbsrv.h
*
* State Machine Service - PHBSRV
* Generated by XFSM v1.0, CodeVer=v0.24
*
* Class Id: CLSID_PHBSRV
*
*
* @version $Id: mmi_phbsrv.h 40247 2009-09-15 03:54:54Z cosmo.sung $
*/
#ifndef __MMI_PHBSRV_H__
#define __MMI_PHBSRV_H__

#include "mmi_mae_common_def.h"
#include "mmi_mae_applet.h"
#include "mmi_mae_class.h"
#include "mmi_phbsrv_def.h"
#include "mmi_mae_datamodel.h"
#include "mmi_mae_vectormodel.h"
#include "mmi_phbsrv_def.h"
#include "mmi_mae_shell.h"
#ifdef __AUTO_TEST_SCRIPT__
#include "mmi_common_util.h"
#endif

/*Data structures for Callback to service wrapper's callback function*/
typedef void (*SRV_PHB_SrvCB)(IBase *callerInstance, MAEInstId_t nInstId, void *ptCnf);

typedef struct callback_data_tag
{
    IBase *callerInstance; // the callerAP's pointer
    MAEInstId_t nInstId; //The unique ID of the AP
    SRV_PHB_SrvCB pSrvCB; //the callback function defined in wrapper
} SrvCallbackData_t;

enum
{
    MMI_PHB_Notify_Mask_PhonebookReady = 1
   ,MMI_PHB_Notify_Mask_ADNMasterReady = 2
   ,MMI_PHB_Notify_Mask_ADNSlaveReady = 4
   ,MMI_PHB_Notify_Mask_PhoneFull = 8
   ,MMI_PHB_Notify_Mask_ExportImportFinish = 16
   ,MMI_PHB_Notify_Mask_Other =32
#ifdef __MMI_PHB_SUPPORT_CONTACT_CHANGED_NOTIFY__
   ,MMI_PHB_Notify_Mask_ContactChanged = 64  // for PHBSRV_EVT_Contact_Changed
#endif
};

typedef s32 MMI_PHB_Notify_Mask_e;

typedef enum
{
    PHB_CONTACT_FIELD_MASK_NONE           = 0,
    PHB_CONTACT_FIELD_MASK_NAME           = 1 << 0,
    PHB_CONTACT_FIELD_MASK_NUMBER         = 1 << 1,
#ifndef __SMALL_PHB_MMI__    
    PHB_CONTACT_FIELD_MASK_COMPANY        = 1 << 2,
    PHB_CONTACT_FIELD_MASK_DEPARTMENT     = 1 << 3,
    PHB_CONTACT_FIELD_MASK_POSITION       = 1 << 4,
    PHB_CONTACT_FIELD_MASK_HOME_ADDRESS   = 1 << 5,
    PHB_CONTACT_FIELD_MASK_OFFICE_ADDRESS = 1 << 6,
    PHB_CONTACT_FIELD_MASK_EMAIL          = 1 << 7,
    PHB_CONTACT_FIELD_MASK_URL            = 1 << 8,
    PHB_CONTACT_FIELD_MASK_NOTE           = 1 << 9,
#endif    
    PHB_CONTACT_FIELD_MASK_IMAGE_ID       = 1 << 10,
    PHB_CONTACT_FIELD_MASK_RINGTONE_ID    = 1 << 11,
#ifndef __SMALL_PHB_MMI__    
    PHB_CONTACT_FIELD_MASK_BIRTHDAY       = 1 << 12,
#endif    
    PHB_CONTACT_FIELD_MASK_GROUP_ID       = 1 << 13,
    PHB_CONTACT_FIELD_MASK_RECEIVER       = 1 << 14,
    PHB_CONTACT_FIELD_MASK_ALL            = 0XFFFF,
}PHBContactFieldMask_e;

enum
{
    MMI_PHB_Recovery_Flag_OFF = 0
   ,MMI_PHB_Recovery_Flag_ON = 1,
};

typedef u8 MMI_PHB_Recovery_Flag_e;

/**
 * External Events
 */
#define PHBSRV_EVT_PhonebookReady               (CLSID_PHBSRV << 16 | 1)
#define PHBSRV_EVT_ADN_M_Ready              (CLSID_PHBSRV << 16 | 2)
#define PHBSRV_EVT_ADN_S_Ready              (CLSID_PHBSRV << 16 | 3)
#define PHBSRV_EVT_Phone_Full               (CLSID_PHBSRV << 16 | 4)
#define PHBSRV_EVT_EXPORT_IMPORT_SUCCESS                (CLSID_PHBSRV << 16 | 5)
#define PHBSRV_EVT_EXPORT_IMPORT_ERROR              (CLSID_PHBSRV << 16 | 6)
#define PHBSRV_EVT_ReadyToCopyADN              (CLSID_PHBSRV << 16 | 7)
#ifdef __MMI_PHB_SUPPORT_CONTACT_CHANGED_NOTIFY__
#define PHBSRV_EVT_Contact_Changed              (CLSID_PHBSRV << 16 | 8)
#endif
/**
 * IPHBSRV Interfaces
 */
#define INHERIT_IPHBSRV(IName) \
    INHERIT_IHandler(IName); \
    u32     (*GetCheckValue)        ( IName * );  \
    boolean     (*IsPhonebookReady)     ( IName * );  \
    MmiPhbReturn_e        (*QueryPhbStatusAsync)        ( IName * , MmiPhbQueryPhbStatusReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*QueryPhbStatusReq)        ( IName * , const IDataModel *ptReq, IDataModel *ptCnf);  \
    MmiPhbReturn_e        (*QueryPhbStatus)     ( IName * , const MmiPhbQueryPhbStatusReq_t *ptParamReq, MmiPhbQueryPhbStatusCnf_t *ptParamCnf);  \
    void                  (*QueryPartialPhbStatus)     ( IName *, MmiPhbBookType_e s32PhbBookType, MmiPhbGroup_e s32PhbGroup, u16 *pu16MaxContacts, u16 *pu16UsedContacts, u8 *pu8MaxNameLen, u8 *pu8MaxNUmberLen);  \
    void                  (*QueryPartialPhbStatusEx)   ( IName *, MmiPhbBookType_e s32PhbBookType, MmiPhbGroup_e s32PhbGroup, u16 *pu16MaxContacts, u16 *pu16UsedContacts, u8 *pu8MaxNameLen, u8 *pu8MaxNUmberLen, u8 *pu8MaxMailLen);  \
    MmiPhbReturn_e        (*ReadOneContactBySortingIdxAsync)        ( IName * , MmiPhbReadOneContactBySortingIdxReq_t *ptParamReq,SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*ReadOneContactPartialBySortingIdx)        ( IName * , const MmiPhbReadPartialBySortingIdxReq_t *ptParamReq, MmiPhbReadPartialBySortingIdxCnf_t *ptParamCnf);  \
    MmiPhbReturn_e        (*ReadOneContactByPhysicalIdxAsync)       ( IName * , MmiPhbReadOneContactByPhysicalIdxReq_t *ptParamReq,SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*ReadOneContactByPhysicalIdx)       ( IName * , const MmiPhbReadOneContactByPhysicalIdxReq_t *ptParamReq, MmiPhbReadOneContactByPhysicalIdxCnf_t *ptParamCnf, boolean bFullContent);  \
    MmiPhbReturn_e        (*ReadOneContactBySortingIdxReq)        ( IName * , const IDataModel *ptReq, IDataModel *ptCnf);  \
    MmiPhbReturn_e        (*ReadOneContactByPhysicalIdxReq)       ( IName * , const IDataModel *ptReq, IDataModel *ptCnf);  \
    MmiPhbReturn_e        (*WriteOneNewContactAsync)     ( IName * , MmiPhbWriteOneNewContactReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*WriteOneNewContactReq)        ( IName * , const IDataModel *ptReq, IDataModel *ptCnf);  \
    MmiPhbReturn_e        (*WriteOneContactByPhysicalIdxAsync)      ( IName * , MmiPhbWriteOneContactByPhysicalIdxReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*WriteOneContactByPhysicalIdxReq)      ( IName * , const IDataModel *ptReq, IDataModel *ptCnf);  \
    MmiPhbReturn_e        (*CopyOneContactByPhysicalIdxAsync)       ( IName * , MmiPhbCopyOneContactByPhysicalIdxReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*CopyOneContactBySortingIdxAsync)        ( IName * , MmiPhbCopyOneContactBySortingIdxReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*CopyAllContactAsync)        ( IName * , MmiPhbCopyAllContactReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    void                    (*CopyAllSIMContactAsync)     ( IName * , MmiPhbBookType_e s32PhbBookType);  \
    MmiPhbReturn_e        (*DeleteOneContactByPhysicalIdxAsync)     ( IName * , MmiPhbDeleteOneContactByPhysicalIdxReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*DeleteOneContactByPhysicalIdxReq)     ( IName * , const IDataModel *ptReq, IDataModel *ptCnf);  \
    MmiPhbReturn_e        (*DeleteOneContactBySortingIdxAsync)      ( IName * , MmiPhbDeleteOneContactBySortingIdxReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*DeleteAllContactAsync)      ( IName * , MmiPhbDeleteAllContactReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*SearchContactByNameAsync)       ( IName * , MmiPhbSearchContactByNameReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*SearchContactByName)       ( IName * , MmiPhbSearchContactByNameReq_t *ptParamReq, MmiPhbSearchContactByNameCnf_t *ptParamCnf);  \
    MmiPhbReturn_e        (*SearchContactSortingIdxByName)       ( IName * , MmiPhbBookType_e  s32PhbBookType, const u8 u8NameLen, const u8 *pu8NameStr, u16 *pu16SortingIdx);  \
    MmiPhbReturn_e        (*SearchContactByNumberAsync)      ( IName * , MmiPhbSearchContactByNumberReq_t *ptParamReq, SrvCallbackData_t *callbackData);  \
    MmiPhbReturn_e        (*SearchContactByNumber)      ( IName * , MmiPhbSearchContactByNumberReq_t *ptParamReq, MmiPhbSearchContactByNumberCnf_t *ptParamCnf);  \
    MmiPhbReturn_e        (*SearchContactNameByNumber)      ( IName * , MmiPhbBookType_e s32PhbBookType, const MmiPhbNumber_t *ptNumber, MmiPhbName_t *ptOutContactName);  \
    MmiPhbReturn_e        (*SearchContactByEmail)   (IName *,  const MmiPhbEmail_t *ptEmail, MmiPhbContactContent_t *ptOutContact, boolean bIsNeedFullContent);  \
    MmiPhbReturn_e        (*SearchContactNameByEmail)   (IName *, const MmiPhbEmail_t *ptEmail,MmiPhbName_t *ptOutContactName);  \
    MmiPhbReturn_e        (*SearchContactsByField)      ( IName * , MmiPhbContactItemDataID_e eSearch_Data, MmiPhbSearchResult_t **ppatSearchResult, u16 *pu16SearchResultTotal);  \
    MmiPhbReturn_e        (*MultiWordPrefixSearch)      ( void * , MmiPhbBookType_e s32PhbBookType,MmiPhbGroup_e s32PhbGroup,MAE_WChar *pwcSearchStr, MmiPhbSearchResult_t **ppatSearchResult, u16 *pu16SearchResultTotal, MMI_PHB_SEARCH_TYPE_E eSearchType);  \
    MmiPhbReturn_e        (*ReadBlackListBySortingIdx)     ( IName * , MmiPhbReadBlackListByRaiIdxReq_t *ptReq, MmiPhbReadBlackListByRaiIdxCnf_t *ptCnf);  \
    MmiPhbReturn_e        (*ReadBlackListNumber)     ( void * , u8 *u8PhbBlackListNumber);  \
    MmiPhbReturn_e        (*SearchBlackListMemberByNumber)      ( IName * , boolean *bBlock, const MmiPhbNumber_t *ptNumber );  \
    MmiPhbReturn_e        (*WriteBlackListNew)      ( IName * , MmiPhbBlackListMemberContent_t *ptPhbContactContent, u16 *pu16Idx );  \
    MmiPhbReturn_e        (*WriteBlackListNewFromPhysicalIdx)      ( IName * , u16 u16PhbPhysicalIdx, u16 *pu16Idx );  \
    MmiPhbReturn_e        (*WriteBlackListBySortingIdx)       ( IName * , MmiPhbBlackListMemberContent_t *ptPhbContactContent, u16 u16PhBlackListRaiIdx );  \
    MmiPhbReturn_e        (*DeleteOneBlackListBySortingIdx)       ( IName * , u16 u16PhBlackListRaiIdx );  \
    MmiPhbReturn_e        (*UpdateOneContactGroupByPhysicalIdx)       ( IName * , u16 u16PhbPhysicalIdx, MmiPhbGroup_e s32PhbGroup, boolean bIsAdd );  \
    void                    (*SetOneContactToGroup)       ( IName * , MmiPhbContactContent_t *contactContent, MmiPhbGroup_e  s32PhbGroup );  \
    void                    (*RemoveOneContactFromGroup)       ( IName * , MmiPhbContactContent_t *contactContent, MmiPhbGroup_e  s32PhbGroup );  \
    boolean                 (*IsInGroup)        ( IName * , MmiPhbGroup_e s32PhbGroup, u32 u32PhbFilter, MmiPhbGroupContent_t *ptGroupContent);  \
    MmiPhbReturn_e        (*GetContactsInGroupStatusArray)        ( IName * , MmiPhbBookType_e  s32PhbBookType, MmiPhbGroup_e s32PhbGroup, boolean *pbSrvCheckStatus);  \
    MmiPhbReturn_e        (*ConvertToPhysicalIdx)      ( IName * , MmiPhbBookType_e s32PhbBookType, MmiPhbGroup_e s32PhbGroup, const u16 u16PhbSortingIdx, u16 *pu16PhbPhysicalIdx  );  \
    MmiPhbReturn_e        (*ConvertToSortingIdx)      ( IName * , MmiPhbBookType_e s32PhbBookType, MmiPhbGroup_e s32PhbGroup, const u16 u16PhbPhysicalIdx, u16 *pu16PhbSortingIdx  );  \
    MmiPhbBJX_t             *(*GetBJXTable)       ( IName * , MmiPhbBookType_e s32PhbBookType, MmiPhbGroup_e s32PhbGroup );  \
    u16                     (*GetModifySerialNo)  ( void );  \
    u16                     (*GetNextExistedIdx)     ( IName * , MmiPhbBookType_e s32BookType, u16 u16CurrentIdx );  \
    void                    (*SetRecoveryFlag)     ( IName * , MMI_PHB_Recovery_Flag_e eRecoveryFlag );  \
    u32                     (*GetReqStructSizeBySrvFid)       ( MmiPhbSrvFunId_e s32PhbSrvFid );  \
    u32                     (*GetCnfStructSizeBySrvFid)       ( MmiPhbSrvFunId_e s32PhbSrvFid );  \
    MAE_Ret                 (*Register_Notification)        ( IName * , void *instance, MMI_PHB_Notify_Mask_e s32Mask);  \
    MAE_Ret                 (*Deregister_Notification)      ( IName * , void *instance, MMI_PHB_Notify_Mask_e s32Mask);  \
    void                    (*StartPhonebookInit)       ( IName * , MmiPhbBookType_e s32PhbBookType, boolean bIsRefresh);  \
    void                    (*StopPhonebookInit)        ( IName * , MmiPhbBookType_e s32PhbBookType);  \
    MAE_Ret                 (*StartAutoWriteSortingTable)       ( IName * , boolean bIsBK,  boolean bIsWriteNow);  \
    MAE_Ret                 (*StopAutoWriteSortingTable)        ( IName * );  \
    void                    (*ChangeModeNotify)     ( IName * , MmiPhbBookType_e s32PhbBookType);  \
    void                    (*RebuildReq)       ( IName * );  \
    MmiPhbResult_e        (*ImportContactFromFileReq)     ( IName * , MmiPhbSrvImportReq_t *pImportReq, boolean bIsFull, boolean bIsSync);  \
    MmiPhbResult_e        (*ExportContactToFileReq)       ( IName * , MmiPhbSrvExportReq_t *pExportReq, boolean bIsFull, boolean bIsSync);  \
    MmiPhbResult_e        (*SuspendExportImportContactReq)        ( IName * , void *userData);  \
    MmiPhbResult_e        (*ResumeExportImportContactReq)     ( IName * , void *userData);  \
    MmiPhbResult_e        (*StopExportImportContactReq)       ( IName * , void *userData);  \
    void                  (*AddReferenceToSortingTable)                 ( IName * );  \
    void                  (*ReleaseReferenceFromSortingTable)           ( IName * ); \
    MmiPhbResult_e        (*SearchPhyIdxByNumber)             ( IName * , MmiPhbBookType_e s32PhbBookType,const MmiPhbNumber_t *ptNumber, u16 *pu16PhyIdx)
DEFINE_INTERFACE(IPHBSRV);


#define IPHBSRV_QueryInterface(pICntlr, id, pp, po)         GET_FUNCTBL((pICntlr), IPHBSRV)->QueryInterface(pICntlr, id, pp, po)
#define IPHBSRV_HandleEvent(pICntlr, e, p1, p2)             GET_FUNCTBL((pICntlr), IPHBSRV)->HandleEvent(pICntlr, e, p1, p2)
/**
 This function will give the called AP a check value.  Once called
AP get phonebook's confirm, it can check the confirm is its or not.
 */
#define IPHBSRV_GetCheckValue(pICntlr)  GET_FUNCTBL((pICntlr), IPHBSRV)->GetCheckValue( pICntlr)

/**
 Check phonebook is ready or not.
 */
#define IPHBSRV_IsPhonebookReady(pICntlr)   GET_FUNCTBL((pICntlr), IPHBSRV)->IsPhonebookReady( pICntlr)

/**
This function is used to query phonebook status with callback.
*/
#define IPHBSRV_QueryPhbStatusAsync(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->QueryPhbStatusAsync( pICntlr, p1, p2)

/**
 This function is used to query phonebook status.
 */
#define IPHBSRV_QueryPhbStatusReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->QueryPhbStatusReq( pICntlr, p1, p2)

/**
    This function is used to query phonebook status.
*/
#define IPHBSRV_QueryPhbStatus(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->QueryPhbStatus( pICntlr, p1, p2)

/**
    This function is used to query phonebook partial status.
*/
#define IPHBSRV_QueryPartialPhbStatus(pICntlr, p1, p2, p3, p4, p5, p6)  GET_FUNCTBL((pICntlr), IPHBSRV)->QueryPartialPhbStatus( pICntlr, p1, p2, p3, p4, p5, p6)


/**
    This function is used to query phonebook partial status with USIM email support status.
*/
#define IPHBSRV_QueryPartialPhbStatusEx(pICntlr, p1, p2, p3, p4, p5, p6, p7)  GET_FUNCTBL((pICntlr), IPHBSRV)->QueryPartialPhbStatusEx( pICntlr, p1, p2, p3, p4, p5, p6, p7)


/**
Read one phonebook contact by sorting index with callback.
*/
#define IPHBSRV_ReadOneContactBySortingIdxAsync(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->ReadOneContactBySortingIdxAsync( pICntlr, p1, p2)

/**
Read one phonebook contact by sorting index.(TO BE REMOVED)
*/
#define IPHBSRV_ReadOneContactBySortingIdxReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->ReadOneContactBySortingIdxReq( pICntlr, p1, p2)


/**
Read one phonebook contact's partial data by sorting index.
*/
#define IPHBSRV_ReadOneContactPartialBySortingIdx(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->ReadOneContactPartialBySortingIdx( pICntlr, p1, p2)

/**
Read one phonebook contact by sorting index with callback.
*/
#define IPHBSRV_ReadOneContactByPhysicalIdxAsync(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->ReadOneContactByPhysicalIdxAsync( pICntlr, p1, p2)

/**
Read one phonebook contact by physical index. (TO BE REMOVED)
*/
#define IPHBSRV_ReadOneContactByPhysicalIdxReq(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->ReadOneContactByPhysicalIdxReq( pICntlr, p1, p2)

/**
Read one phonebook contact by phy index.
*/
#define IPHBSRV_ReadOneContactByPhysicalIdx(pICntlr, p1, p2, p3) GET_FUNCTBL((pICntlr), IPHBSRV)->ReadOneContactByPhysicalIdx( pICntlr, p1, p2, p3)

/**
 Read multi phonebook contact by sorting index.
 */
//#define IPHBSRV_ReadMultiContactBySortingIdxReq(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->ReadMultiContactBySortingIdxReq( pICntlr, p1, p2)
/**
 Read multi phonebook contact by physical index.
 */
//#define IPHBSRV_ReadMultiContactByPhysicalIdxReq(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->ReadMultiContactByPhysicalIdxReq( pICntlr, p1, p2)

/**
Write one new contact Async.
*/
#define IPHBSRV_WriteOneNewContactAsync(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->WriteOneNewContactAsync( pICntlr, p1, p2)


/**
 Write one new contact.(TO BE REMOVED)
 */
#define IPHBSRV_WriteOneNewContactReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->WriteOneNewContactReq( pICntlr, p1, p2)

/**
Write one contact by physical index Async.
*/
#define IPHBSRV_WriteOneContactByPhysicalIdxAsync(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->WriteOneContactByPhysicalIdxAsync( pICntlr, p1, p2)


/**
 Write one contact by physical index.(TO BE REMOVED)
 */
#define IPHBSRV_WriteOneContactByPhysicalIdxReq(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->WriteOneContactByPhysicalIdxReq( pICntlr, p1, p2)

/**
 Write multi new contact.
 */
//#define IPHBSRV_WriteMultiNewContactReq(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->WriteMultiNewContactReq( pICntlr, p1, p2)
/**
 Write multi contact by physical index.
 */
//#define IPHBSRV_WriteMultiContactByPhysicalIdxReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->WriteMultiContactByPhysicalIdxReq( pICntlr, p1, p2)

/**
Copy one contact between SIM and Phone by physical index with Callback function.
*/
#define IPHBSRV_CopyOneContactByPhysicalIdxAsync(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->CopyOneContactByPhysicalIdxAsync( pICntlr, p1, p2)

/**
Copy one contact between SIM and Phone by sorting index  with Callback function.
*/
#define IPHBSRV_CopyOneContactBySortingIdxAsync(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->CopyOneContactBySortingIdxAsync( pICntlr, p1, p2)

/**
 Copy multi contact between SIM and Phone by sorting index.
 */
//#define IPHBSRV_CopyMultiContactBySortingIdxReq(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->CopyMultiContactBySortingIdxReq( pICntlr, p1, p2)

/**
Copy all contact between SIM and Phone with Callback Function.
*/
#define IPHBSRV_CopyAllContactAsync(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->CopyAllContactAsync( pICntlr, p1, p2)

/**
Copy all SIM contacts to phone.
*/
#define IPHBSRV_CopyAllSIMContactAsync(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->CopyAllSIMContactAsync( pICntlr, p1)

/**
Delete one contact by physical index with callback function.
*/
#define IPHBSRV_DeleteOneContactByPhysicalIdxAsync(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteOneContactByPhysicalIdxAsync( pICntlr, p1, p2)


/**
 Delete one contact by physical index.(TO BE REMOVED)
 */
#define IPHBSRV_DeleteOneContactByPhysicalIdxReq(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteOneContactByPhysicalIdxReq( pICntlr, p1, p2)

/**
 Delete multi contact by physical index.
 */
//#define IPHBSRV_DeleteMultiContactByPhysicalIdxReq(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteMultiContactByPhysicalIdxReq( pICntlr, p1, p2)

/**
Delete one contact by sorting index with callback function.
*/
#define IPHBSRV_DeleteOneContactBySortingIdxAsync(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteOneContactBySortingIdxAsync( pICntlr, p1, p2)

/**
 Delete multi contact by sorting index.
 */
//#define IPHBSRV_DeleteMultiContactBySortingIdxReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteMultiContactBySortingIdxReq( pICntlr, p1, p2)

/**
Delete all contact with callback function.
*/
#define IPHBSRV_DeleteAllContactAsync(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteAllContactAsync( pICntlr, p1, p2)

/**
Search contact by name with callback function.
*/
#define IPHBSRV_SearchContactByNameAsync(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactByNameAsync( pICntlr, p1, p2)

/**
Search contact by name
*/
#define IPHBSRV_SearchContactByName(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactByName( pICntlr, p1, p2)

/**
Search contact sorting index by name.
*/
#define IPHBSRV_SearchContactSortingIdxByName(pICntlr, p1, p2, p3, p4)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactSortingIdxByName( pICntlr, p1, p2, p3, p4)


/**
Search contact by number with callback function.
*/
#define IPHBSRV_SearchContactByNumberAsync(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactByNumberAsync( pICntlr, p1, p2)

/**
Search contact by number.
*/
#define IPHBSRV_SearchContactByNumber(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactByNumber( pICntlr, p1, p2)

/**
Search contact name by number.
*/
#define IPHBSRV_SearchContactNameByNumber(pICntlr, p1, p2, p3)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactNameByNumber( pICntlr, p1, p2, p3)



/**
Search contact by email.
*/
#define IPHBSRV_SearchContactByEmail(pICntlr, p1, p2, p3)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactByEmail( pICntlr, p1, p2, p3)


/**
Search contact name by email.
*/
#define IPHBSRV_SearchContactNameByEmail(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactNameByEmail( pICntlr, p1, p2)


/**
Search contact by specified field.
*/
#define IPHBSRV_SearchContactsByField(pICntlr, p1, p2, p3)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchContactsByField( pICntlr, p1, p2, p3)

/**
MultiWordPrefixSearch
*/
#define IPHBSRV_MultiWordPrefixSearch(pICntlr, p1, p2, p3, p4, p5, p6)   GET_FUNCTBL((pICntlr), IPHBSRV)->MultiWordPrefixSearch( pICntlr, p1, p2, p3, p4, p5, p6)



/**
Read black list by sorting index.
*/
#define IPHBSRV_ReadBlackListBySortingIdx(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->ReadBlackListBySortingIdx( pICntlr, p1, p2)

/**
Read black list by sorting index.
*/
#define IPHBSRV_ReadBlackListNumber(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->ReadBlackListNumber( pICntlr, p1)

/**
Search contact in black list by number.
*/
#define IPHBSRV_SearchBlackListMemberByNumber(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->SearchBlackListMemberByNumber( pICntlr, p1, p2)

/**
Add contact content to blacklist.
*/
#define IPHBSRV_WriteBlackListNew(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->WriteBlackListNew( pICntlr, p1, p2)

/**
Add an existing contact to blacklist.
*/
#define IPHBSRV_WriteBlackListNewFromPhysicalIdx(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->WriteBlackListNewFromPhysicalIdx( pICntlr, p1, p2)


/**
Write contact to black list by sorting index.
*/
#define IPHBSRV_WriteBlackListBySortingIdx(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->WriteBlackListBySortingIdx( pICntlr, p1, p2)

/**
Delete contact in black list by sorting index.
*/
#define IPHBSRV_DeleteOneBlackListBySortingIdx(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->DeleteOneBlackListBySortingIdx( pICntlr, p1)

/**
Update a contact's group by physical index. (group + blacklist)
*/
#define IPHBSRV_UpdateOneContactGroupByPhysicalIdx(pICntlr, p1, p2, p3)   GET_FUNCTBL((pICntlr), IPHBSRV)->UpdateOneContactGroupByPhysicalIdx( pICntlr, p1, p2, p3)

/**
Set a contact to a group
*/
#define IPHBSRV_SetOneContactToGroup(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->SetOneContactToGroup( pICntlr, p1, p2)

/**
Remove a contact from a group
*/
#define IPHBSRV_RemoveOneContactFromGroup(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->RemoveOneContactFromGroup( pICntlr, p1, p2)

/**
Check is the contact in group or not and get group's properties.
*/
#define IPHBSRV_IsInGroup(pICntlr, p1, p2, p3)  GET_FUNCTBL((pICntlr), IPHBSRV)->IsInGroup( pICntlr, p1, p2, p3)

/**
The function returns an Array of bits, representing the contacts
that belongs to the group specified.
*/
#define IPHBSRV_GetContactsInGroupStatusArray(pICntlr, p1, p2, p3)  GET_FUNCTBL((pICntlr), IPHBSRV)->GetContactsInGroupStatusArray( pICntlr, p1, p2, p3)

/**
Convert from Physical Idx to Sorting Idx
*/
#define IPHBSRV_ConvertToPhysicalIdx(pICntlr, p1, p2, p3, p4)   GET_FUNCTBL((pICntlr), IPHBSRV)->ConvertToPhysicalIdx( pICntlr, p1, p2, p3, p4)


/**
Convert from Sorting Idx to Physical Idx
*/
#define IPHBSRV_ConvertToSortingIdx(pICntlr, p1, p2, p3, p4)   GET_FUNCTBL((pICntlr), IPHBSRV)->ConvertToSortingIdx( pICntlr, p1, p2, p3, p4)


/**
Get the Table for BJX App
*/
#define IPHBSRV_GetBJXTable(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->GetBJXTable( pICntlr, p1, p2)


/**
Get the Serial No. The SN isupdate everytime the PHB data is changed
*/
#define IPHBSRV_GetModifySerialNo(pICntlr)   GET_FUNCTBL((pICntlr), IPHBSRV)->GetModifySerialNo()


/**
Get Next Existing Idx (For Sync App)
*/
#define IPHBSRV_GetNextExistedIdx(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), IPHBSRV)->GetNextExistedIdx( pICntlr, p1, p2)


/**
Set Recovery Flag
*/
#define IPHBSRV_SetRecoveryFlag(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->SetRecoveryFlag( pICntlr, p1)

/**
Set a contact to a group
*/
#define IPHBSRV_GetReqStructSizeBySrvFid(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->GetReqStructSizeBySrvFid(p1)

/**
Remove a contact from a group
*/
#define IPHBSRV_GetCnfStructSizeBySrvFid(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->GetCnfStructSizeBySrvFid(p1)

/**
 Read call record by sorting index.
 */
//#define IPHBSRV_ReadCallRecordBySortingIdxReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->ReadCallRecordBySortingIdxReq( pICntlr, p1, p2)
/**
 Write call record by sorting index.
 */
//#define IPHBSRV_WriteCallRecordBySortingIdxReq(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->WriteCallRecordBySortingIdxReq( pICntlr, p1, p2)

/**
 Register phonebook notification.
 */
#define IPHBSRV_Register_Notification(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), IPHBSRV)->Register_Notification( pICntlr, p1, p2)

/**
 Deregister phonebook notification.
 */
#define IPHBSRV_Deregister_Notification(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), IPHBSRV)->Deregister_Notification( pICntlr, p1, p2)

/**
 Ask PHBSRV to start init.
 */
#define IPHBSRV_StartPhonebookInit(pICntlr, p1, p2) GET_FUNCTBL((pICntlr), IPHBSRV)->StartPhonebookInit( pICntlr, p1, p2)

/**
 Ask PHBSRV to stop init.
 */
#define IPHBSRV_StopPhonebookInit(pICntlr, p1)  GET_FUNCTBL((pICntlr), IPHBSRV)->StopPhonebookInit( pICntlr, p1)

/**
 Set on and start to auto write sorting table.
 */
//#ifdef __MMI_PHB_BK_WITH_SORTING__
#define IPHBSRV_StartAutoWriteSortingTable(pICntlr, p1, p2)	GET_FUNCTBL((pICntlr), IPHBSRV)->StartAutoWriteSortingTable( pICntlr, p1, p2)
//#else
//#define IPHBSRV_StartAutoWriteSortingTable(pICntlr, p1) GET_FUNCTBL((pICntlr), IPHBSRV)->StartAutoWriteSortingTable( pICntlr, p1)
//#endif
/**
 Set off and stop to auto write sorting table.
 */

#define IPHBSRV_StopAutoWriteSortingTable(pICntlr)  GET_FUNCTBL((pICntlr), IPHBSRV)->StopAutoWriteSortingTable( pICntlr)


/**
 Notify PHBSRV the mode was changed. (Dual, Master, Slave or inactive)
 */
#define IPHBSRV_ChangeModeNotify(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->ChangeModeNotify( pICntlr, p1)

/**
 Request to rebuild sorting table.
 */
#define IPHBSRV_RebuildReq(pICntlr) GET_FUNCTBL((pICntlr), IPHBSRV)->RebuildReq( pICntlr)

/**
 ImportContactFromFileReq
 */
#define IPHBSRV_ImportContactFromFileReq(pICntlr, p1, p2, p3)   GET_FUNCTBL((pICntlr), IPHBSRV)->ImportContactFromFileReq( pICntlr, p1, p2, p3)

/**
 ExportContactToFileReq
 */
#define IPHBSRV_ExportContactToFileReq(pICntlr, p1, p2, p3) GET_FUNCTBL((pICntlr), IPHBSRV)->ExportContactToFileReq( pICntlr, p1, p2, p3)

/**
 suspend the importing , exporting
 */
#define IPHBSRV_SuspendExportImportContactReq(pICntlr, p1)  GET_FUNCTBL((pICntlr), IPHBSRV)->SuspendExportImportContactReq( pICntlr, p1)

/**
 resume the importing , exporting
 */
#define IPHBSRV_ResumeExportImportContactReq(pICntlr, p1)   GET_FUNCTBL((pICntlr), IPHBSRV)->ResumeExportImportContactReq( pICntlr, p1)

/**
 stop the importing , exporting
 */
#define IPHBSRV_StopExportImportContactReq(pICntlr, p1) GET_FUNCTBL((pICntlr), IPHBSRV)->StopExportImportContactReq( pICntlr, p1)

/**
Search contact phyidx by number    
*/
#define IPHBSRV_SearchPhyIdxByNumber(pICntlr, p1, p2, p3) GET_FUNCTBL((pICntlr), IPHBSRV)->SearchPhyIdxByNumber( pICntlr, p1, p2, p3)

/**
 AddReferenceToSortingTable
 */
#define IPHBSRV_AddReferenceToSortingTable(pICntlr) GET_FUNCTBL((pICntlr), IPHBSRV)->AddReferenceToSortingTable( pICntlr )

/**
 UnlockSortingTable
 */
#define IPHBSRV_ReleaseReferenceFromSortingTable(pICntlr) GET_FUNCTBL((pICntlr), IPHBSRV)->ReleaseReferenceFromSortingTable( pICntlr )


/**mmi_PHBSRV_FuzzyNumberSearch
* @brief: 使用号码对电话本进行模糊查询    
* @param[in]  pData             Pointer to the MMI_PHBSRV
* @param[in]  s32PhbBookType    Search record by the phone book type
* @param[in]  s32PhbGroup       Search record in the phone book group
* @param[in]  pwcSearchStr      Pointer to the search string
* @param[in]  pIVCalllog        Pointer to the vector class (the vector model stroe call log search result)
* @param[out] ppatSearchResult  Pointer to the search result by phone book
* @param[out] pu16SearchResultTotal  Pointer to the search result items number
* @return     MMI_PHB_RESULT_OK     if successful
*/
MmiPhbResult_e mmi_PHBSRV_FuzzyNumberSearch( void *pData,
                                            MmiPhbBookType_e			s32PhbBookType,
                                            MmiPhbGroup_e            s32PhbGroup,
                                            MAE_WChar                  *pwcSearchStr,
                                            VectorClass_t               *pIVCalllog,
                                            MmiPhbSearchResultForNum_t **ppatSearchResult,
                                            u16                        *pu16SearchResultTotal);

/**
 * Functions
 */

void PHBSRV_Init(void);

__SLDPM_FREE__ MAE_Ret PHBSRV_New(MAE_ClsId id, void **ppObj);


/*fl.du modify end*/
/* Cosmo, end */

/* Public functions for converting between ID and Url*/
MAE_Ret mmi_PHBSRV_RegHashID(MAE_WChar *pInputUrl, u32 *pOutputHashID);
MAE_Ret mmi_PHBSRV_DeregHashID(u32 *pOutputHashID);
__SLDPM_FREE__ MAE_Ret mmi_PHBSRV_LoopUrl(IPHBSRV *pIPHBSRV, u32 u32RegId, MAE_WChar *pszUrl);

u16 mmi_PHBSRV_ConvertLocalSortingIdxToTotal(void				*pThis, 
											 MmiPhbBookType_e	s32PhbBookType, 
											 MmiPhbGroup_e		s32PhbGroup, 
											 u16				u16PhbSortingIdx);

#ifndef __MMI_PHB_DISABLE_IMPORT_EXPORT__
static MAE_Ret _mmi_PHBSRV_CheckExportDir(MmiPhbExportPath_e eExportPath, MmiPhbExportType_e eExportType);
#endif // #ifndef __MMI_PHB_DISABLE_IMPORT_EXPORT__

#if defined(__MMI_PHB_SMART_ALPHABET_FILTER_SUPPORT__) || defined(__MMI_PHB_SMART_NUMBER_FILTER_SUPPORT__)
MAE_Ret mmi_PHBSRV_SetFuzzyNumberSearchType(MmiPhbSrvFuzzySearchType_e eFuzzySearchType);
MmiPhbSrvFuzzySearchType_e mmi_PHBSRV_GetFuzzyNumberSearchType(void);
#endif

MAE_Ret mmi_PHBSRV_MasterRestore(void);

void mmi_PHBSRV_SetADNStatusEx(MmiPhbBookType_e s32PhbBookType, u16 u16MaxEmailNum, u16 u16UsedEmailNum, u16 u16MaxExtNum, u16 u16UsedExtNum);
void mmi_PHBSRV_GetADNStatusEx(MmiPhbBookType_e s32PhbBookType, u16 *pu16MaxEmailNum, u16 *pu16UsedEmailNum, u16 *pu16MaxExtNum, u16 *pu16UsedExtNum);

#endif /* __MMI_PHBSRV_H__ */
